---
phase: 01-foundation
plan: 03
type: execute
wave: 2
depends_on: ["01-01"]
files_modified: [packages/backend/package.json, packages/backend/tsconfig.json, packages/backend/src/index.ts, packages/backend/src/types.ts, packages/backend/.env.example]
autonomous: true
---

<objective>
Scaffold Node.js Express backend in monorepo.

Purpose: Create the API server foundation with TypeScript. Link to shared types for consistency with mobile app.
Output: Working Express server with health endpoint, importing from @draugar/shared.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize Express project</name>
  <files>packages/backend/package.json, packages/backend/tsconfig.json</files>
  <action>
    1. Create packages/backend/package.json:
       - name: "@draugar/backend"
       - main: "dist/index.js"
       - scripts: {"build": "tsc", "dev": "tsx watch src/index.ts", "start": "node dist/index.js", "typecheck": "tsc --noEmit"}
       - dependencies: express, dotenv
       - devDependencies: typescript, tsx, @types/node, @types/express
       - Add workspace dependency: "@draugar/shared": "workspace:*"
    2. Create packages/backend/tsconfig.json:
       - extends: "../../tsconfig.json"
       - compilerOptions: outDir: "dist", rootDir: "src"
       - include: ["src/**/*"]
    3. Run pnpm install from root
  </action>
  <verify>pnpm install succeeds, packages/backend/node_modules exists</verify>
  <done>Backend package initialized with Express and TypeScript dependencies</done>
</task>

<task type="auto">
  <name>Task 2: Create Express server with health endpoint</name>
  <files>packages/backend/src/index.ts, packages/backend/src/types.ts, packages/backend/.env.example</files>
  <action>
    1. Create packages/backend/src/index.ts:
       - Import express, dotenv
       - Import { User, Location } from '@draugar/shared' (to verify types work)
       - Create express app
       - Add GET /health endpoint returning { status: 'ok', timestamp: Date }
       - Listen on PORT from env (default 3001)
       - Log startup message
    2. Create packages/backend/src/types.ts:
       - Re-export types from @draugar/shared
       - Add any backend-specific types (none yet, placeholder)
    3. Create packages/backend/.env.example:
       - PORT=3001
  </action>
  <verify>cd packages/backend && pnpm build succeeds, dist/index.js exists</verify>
  <done>Express server with /health endpoint created and builds</done>
</task>

<task type="auto">
  <name>Task 3: Verify server runs</name>
  <files>packages/backend/src/index.ts</files>
  <action>
    1. From packages/backend, run: pnpm dev (starts tsx watch)
    2. In another terminal: curl http://localhost:3001/health
    3. Should return JSON: {"status":"ok","timestamp":"..."}
    4. Stop the dev server after verification

    Note: tsx provides fast TypeScript execution without separate compile step for development.
  </action>
  <verify>curl localhost:3001/health returns {"status":"ok",...}</verify>
  <done>Backend server runs and responds to health check</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] packages/backend/ has valid Node.js project structure
- [ ] @draugar/shared is listed as workspace dependency
- [ ] `pnpm build` succeeds in backend package
- [ ] TypeScript compiles without errors
- [ ] Server starts with `pnpm dev`
- [ ] GET /health returns valid JSON response
</verification>

<success_criteria>

- All tasks completed
- Express project scaffolded in monorepo
- Shared types accessible from backend package
- Health endpoint responds correctly
- Ready for Phase 2 (PostgreSQL, API structure, WebSocket)
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-03-SUMMARY.md`
</output>
